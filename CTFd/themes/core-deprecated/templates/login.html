{% extends "base.html" %}

{% block stylesheets %}
	<!-- Manga Login Page Styles -->
	<style>
		/* Manga Panel - Login Page */
		
		/* Hero Jumbotron */
		.jumbotron {
			background: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
			border-bottom: 4px solid #f5f5f5;
			border-top: 4px solid #f5f5f5;
			border-radius: 0;
			padding: 3rem 1rem;
			margin-bottom: 3rem;
			box-shadow: 
				0 6px 0 rgba(0,0,0,0.8),
				inset 0 0 0 1px rgba(255,255,255,0.1);
			position: relative;
		}
		
		.jumbotron::before {
			content: "";
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: repeating-linear-gradient(
				-45deg,
				transparent,
				transparent 20px,
				rgba(255,255,255,0.01) 20px,
				rgba(255,255,255,0.01) 40px
			);
			pointer-events: none;
		}
		
		.jumbotron .container {
			position: relative;
			z-index: 1;
		}
		
		.jumbotron h1 {
			color: #f5f5f5;
			font-family: "Rajdhani", sans-serif;
			font-weight: 900;
			font-size: 3.5rem;
			text-transform: uppercase;
			letter-spacing: 8px;
			margin: 0;
			text-shadow: 
				3px 3px 0 #000,
				-1px -1px 0 #000,
				1px -1px 0 #000,
				-1px 1px 0 #000,
				6px 6px 0 rgba(0,0,0,0.3);
		}
		
		/* Login Container */
		.login-container {
			animation: fadeInUp 0.8s ease;
		}
		
		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
		
		/* Login Card - Manga Panel */
		.login-card {
			background: #1a1a1a;
			border: 4px solid #2a2a2a;
			border-radius: 0;
			padding: 3rem 2.5rem;
			box-shadow: 
				8px 8px 0 rgba(0,0,0,0.5),
				inset 0 0 0 1px rgba(255,255,255,0.05);
			transition: all 0.3s ease;
			position: relative;
		}
		
		.login-card::before {
			content: "";
			position: absolute;
			top: -6px;
			left: -6px;
			right: -6px;
			bottom: -6px;
			border: 1px solid rgba(255,255,255,0.1);
			pointer-events: none;
		}
		
		.login-card:hover {
			border-color: #3a3a3a;
			box-shadow: 
				10px 10px 0 rgba(0,0,0,0.5),
				inset 0 0 0 1px rgba(255,255,255,0.1);
		}
		
		/* Login Icon */
		.login-icon {
			text-align: center;
			margin-bottom: 2rem;
			position: relative;
		}
		
		.login-icon::before {
			content: "";
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 120px;
			height: 120px;
			border: 3px solid rgba(255,255,255,0.1);
			border-radius: 50%;
		}
		
		.login-icon::after {
			content: "";
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 140px;
			height: 140px;
			border: 2px solid rgba(255,255,255,0.05);
			border-radius: 50%;
		}
		
		/* Welcome Text */
		.login-welcome {
			text-align: center;
			margin-bottom: 2.5rem;
			position: relative;
			padding: 1.5rem;
			background: repeating-linear-gradient(
				0deg,
				transparent,
				transparent 4px,
				rgba(255,255,255,0.02) 4px,
				rgba(255,255,255,0.02) 8px
			);
		}
		
		.login-welcome h2 {
			color: #f5f5f5;
			font-family: "Rajdhani", sans-serif;
			font-weight: 900;
			font-size: 2rem;
			margin-bottom: 0.5rem;
			letter-spacing: 3px;
			text-transform: uppercase;
			text-shadow: 2px 2px 0 #000;
		}
		
		.login-welcome p {
			color: #b0b0b0;
			font-size: 1rem;
			font-weight: 600;
			letter-spacing: 1px;
		}
		
		/* Form Labels */
		.login-card .form-group label,
		.login-card .form-group b {
			color: #f5f5f5;
			font-weight: 900;
			font-size: 0.9rem;
			text-transform: uppercase;
			letter-spacing: 2px;
			margin-bottom: 0.5rem;
			display: block;
			font-family: "Rajdhani", sans-serif;
		}
		
		/* Form Inputs */
		.login-card .form-control {
			background: #0a0a0a;
			border: 3px solid #2a2a2a;
			color: #e0e0e0;
			padding: 1rem;
			font-size: 1rem;
			border-radius: 0;
			transition: all 0.3s ease;
			height: auto;
			font-weight: 600;
		}
		
		.login-card .form-control:focus {
			background: #0a0a0a;
			border-color: #f5f5f5;
			box-shadow: 
				0 0 0 3px rgba(255,255,255,0.1),
				inset 0 0 10px rgba(255,255,255,0.05);
			color: #e0e0e0;
			outline: none;
		}
		
		.login-card .form-control:hover {
			border-color: #3a3a3a;
		}
		
		.login-card .form-control::placeholder {
			color: #4a4a4a;
			font-weight: 500;
		}
		
		/* Form Group Spacing */
		.login-card .form-group {
			margin-bottom: 2rem;
		}
		
		/* OAuth Login Button */
		.btn-secondary.btn-lg {
			background: linear-gradient(180deg, #2a2a2a 0%, #1a1a1a 100%);
			border: 3px solid #2a2a2a;
			color: #e0e0e0;
			padding: 1rem 2rem;
			font-size: 1.1rem;
			font-weight: 900;
			text-transform: uppercase;
			letter-spacing: 2px;
			border-radius: 0;
			transition: all 0.2s ease;
			box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
		}
		
		.btn-secondary.btn-lg:hover {
			background: linear-gradient(180deg, #3a3a3a 0%, #2a2a2a 100%);
			border-color: #f5f5f5;
			color: #f5f5f5;
			transform: translate(-2px, -2px);
			box-shadow: 6px 6px 0 rgba(0,0,0,0.5);
		}
		
		/* Divider */
		.login-card hr {
			border-top: 3px solid #2a2a2a;
			margin: 2.5rem 0;
			position: relative;
		}
		
		.login-card hr::after {
			content: "OR";
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background: #1a1a1a;
			padding: 0 1rem;
			color: #7f8c8d;
			font-weight: 900;
			letter-spacing: 2px;
		}
		
		/* Submit Button */
		.login-card .btn-primary {
			background: #f5f5f5;
			border: 3px solid #0a0a0a;
			color: #0a0a0a;
			padding: 0.875rem 2rem;
			font-size: 1rem;
			font-weight: 900;
			text-transform: uppercase;
			letter-spacing: 2px;
			border-radius: 0;
			transition: all 0.2s ease;
			box-shadow: 4px 4px 0 rgba(0,0,0,0.8);
		}
		
		.login-card .btn-primary:hover {
			background: #fff;
			border-color: #0a0a0a;
			color: #0a0a0a;
			transform: translate(-2px, -2px);
			box-shadow: 6px 6px 0 rgba(0,0,0,0.8);
		}
		
		.login-card .btn-primary:active {
			transform: translate(1px, 1px);
			box-shadow: 3px 3px 0 rgba(0,0,0,0.8);
		}
		
		/* Forgot Password Link */
		.align-text-to-button {
			color: #b0b0b0;
			text-decoration: none;
			font-weight: 700;
			transition: all 0.3s ease;
			display: inline-flex;
			align-items: center;
			line-height: 1.5;
			letter-spacing: 1px;
			border-bottom: 2px solid transparent;
		}
		
		.align-text-to-button:hover {
			color: #f5f5f5;
			text-decoration: none;
			border-bottom-color: #f5f5f5;
		}
		
		/* Loading State */
		.btn-primary.loading {
			opacity: 0.6;
			cursor: not-allowed;
			pointer-events: none;
		}
		
		.btn-primary.loading::after {
			content: "";
			display: inline-block;
			width: 14px;
			height: 14px;
			margin-left: 10px;
			border: 3px solid #0a0a0a;
			border-top-color: transparent;
			border-radius: 50%;
			animation: btnSpin 0.8s linear infinite;
		}
		
		@keyframes btnSpin {
			to { transform: rotate(360deg); }
		}
		
		/* Input Validation States */
		.form-control.is-valid {
			border-color: #b0b0b0;
		}
		
		.form-control.is-invalid {
			border-color: #7f8c8d;
			background: repeating-linear-gradient(
				45deg,
				#0a0a0a,
				#0a0a0a 10px,
				rgba(127,140,141,0.1) 10px,
				rgba(127,140,141,0.1) 20px
			);
		}
		
		/* Error Messages */
		.alert {
			border-radius: 0;
			border: 3px solid;
			font-weight: 700;
			animation: slideIn 0.3s ease;
			letter-spacing: 1px;
		}
		
		@keyframes slideIn {
			from {
				opacity: 0;
				transform: translateY(-10px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
		
		.alert-danger {
			background: rgba(127,140,141,0.2);
			border-color: #7f8c8d;
			color: #e0e0e0;
		}
		
		.alert-success {
			background: rgba(176,176,176,0.2);
			border-color: #b0b0b0;
			color: #e0e0e0;
		}
		
		/* Security Badge */
		.security-badge {
			text-align: center;
			margin-top: 2rem;
			padding-top: 1.5rem;
			border-top: 2px solid #2a2a2a;
		}
		
		.security-badge small {
			color: #7f8c8d;
			font-size: 0.8rem;
			font-weight: 600;
			letter-spacing: 1px;
		}
		
		/* Responsive Design */
		@media (max-width: 768px) {
			.jumbotron h1 {
				font-size: 2.5rem;
				letter-spacing: 4px;
			}
			
			.login-card {
				padding: 2rem 1.5rem;
			}
			
			.login-card .btn-primary,
			.btn-secondary.btn-lg {
				width: 100%;
				margin-top: 0.5rem;
			}
			
			.align-text-to-button {
				display: block;
				text-align: center;
				margin-bottom: 1rem;
			}
		}
		
		/* Password Toggle Button */
		.password-toggle {
			position: absolute;
			right: 15px;
			top: 50%;
			transform: translateY(-50%);
			background: none;
			border: none;
			color: #7f8c8d;
			cursor: pointer;
			transition: color 0.3s ease;
			font-size: 1.2rem;
			z-index: 10;
		}
		
		.password-toggle:hover {
			color: #f5f5f5;
		}
	</style>
{% endblock %}

{% block content %}
<!-- Hero Jumbotron -->
<div class="jumbotron">
	<div class="container">
		<h1>LOGIN</h1>
	</div>
</div>

<!-- Login Container -->
<div class="container login-container">
	<div class="row">
		<div class="col-md-6 offset-md-3">
			<div class="login-card">
				<!-- Login Icon -->
				<div class="login-icon">
					<svg width="80" height="80" viewBox="0 0 80 80" style="filter: drop-shadow(2px 2px 0 #000);">
						<circle cx="40" cy="40" r="38" fill="none" stroke="#f5f5f5" stroke-width="3"/>
						<circle cx="40" cy="30" r="12" fill="#f5f5f5"/>
						<path d="M 20 60 Q 20 45 40 45 T 60 60" fill="#f5f5f5"/>
					</svg>
				</div>
				
				<!-- Welcome Text -->
				<div class="login-welcome">
					<h2>Welcome Back</h2>
					<p>Enter your credentials to continue</p>
				</div>
				
				<!-- Error Messages -->
				{% include "components/errors.html" %}

				<!-- OAuth Login (if enabled) -->
				{% if integrations.mlc() %}
				<a class="btn btn-secondary btn-lg btn-block" href="{{ url_for('auth.oauth_login') }}">
					Login with Major League Cyber
				</a>

				<hr>
				{% endif %}

				<!-- Login Form -->
				{% with form = Forms.auth.LoginForm() %}
				<form method="post" accept-charset="utf-8" autocomplete="off" id="login-form">
					<div class="form-group">
						<b>{{ form.name.label }}</b>
						{{ form.name(class="form-control", value=name, placeholder="Username or Email") }}
					</div>
					<div class="form-group">
						<b>{{ form.password.label }}</b>
						<div style="position: relative;">
							{{ form.password(class="form-control", value=password, placeholder="Password") }}
						</div>
					</div>
					<div class="row pt-3">
						<div class="col-md-6">
							<a class="float-left align-text-to-button" href="{{ url_for('auth.reset_password') }}">
								Forgot Password?
							</a>
						</div>
						<div class="col-md-6">
							{{ form.submit(class="btn btn-md btn-primary btn-outlined float-right", id="login-submit") }}
						</div>
					</div>
					{{ form.nonce() }}
				</form>
				{% endwith %}
				
				<!-- Security Badge -->
				<div class="security-badge">
					<small>Secure Connection Established</small>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
	const form = document.getElementById('login-form');
	const submitBtn = document.getElementById('login-submit');
	const inputs = form.querySelectorAll('.form-control');
	
	// Add loading state on form submission
	form.addEventListener('submit', function(e) {
		submitBtn.classList.add('loading');
		submitBtn.disabled = true;
	});
	
	// Real-time input validation
	inputs.forEach(function(input) {
		input.addEventListener('blur', function() {
			if (this.value.trim() !== '') {
				this.classList.add('is-valid');
				this.classList.remove('is-invalid');
			} else {
				this.classList.add('is-invalid');
				this.classList.remove('is-valid');
			}
		});
		
		input.addEventListener('input', function() {
			this.classList.remove('is-valid', 'is-invalid');
		});
	});
	
	// Password visibility toggle
	const passwordInput = form.querySelector('input[type="password"]');
	if (passwordInput) {
		const toggleBtn = document.createElement('button');
		toggleBtn.type = 'button';
		toggleBtn.className = 'password-toggle';
		toggleBtn.innerHTML = '<i class="fas fa-eye"></i>';
		
		passwordInput.parentNode.appendChild(toggleBtn);
		
		toggleBtn.addEventListener('click', function() {
			if (passwordInput.type === 'password') {
				passwordInput.type = 'text';
				this.innerHTML = '<i class="fas fa-eye-slash"></i>';
			} else {
				passwordInput.type = 'password';
				this.innerHTML = '<i class="fas fa-eye"></i>';
			}
		});
	}
	
	// Enter key submission enhancement
	inputs.forEach(function(input) {
		input.addEventListener('keypress', function(e) {
			if (e.key === 'Enter') {
				e.preventDefault();
				form.submit();
			}
		});
	});
	
	// Focus first input
	const firstInput = form.querySelector('.form-control');
	if (firstInput) {
		setTimeout(function() {
			firstInput.focus();
		}, 300);
	}
});
</script>
{% endblock %}